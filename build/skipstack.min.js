!function(){function t(){return["precision mediump float;uniform float time;uniform vec2 resolution;void main( void ){gl_FragColor=vec4( 1.0 );vec2 p=gl_FragCoord.xy / resolution -0.5;vec2 r=vec2(length(p), atan(p.x, p.y));r.y=fract(time+abs(1.0-sin(time)*3.0)*r.y/3.141592653);if(r.x > .22 && r.x < .4 && r.y < 0.9){gl_FragColor.rgb *=vec3(0.0, 0.7, 0.8) / ( smoothstep(0.0, 0.07, dot(r.x,r.x)) * smoothstep(0.3, 0.1, dot(r.x,r.x)) + smoothstep(0.9, 0.92, dot(r.y,r.y)) );}}"]}function e(){console.log("SkipStack version: "+St.version+"\nGrid Scale: "+jt+", "+Bt+"\nGameType: "+it+"\nDifficulty: "+Mt),dt=ft=[],l(),"Endless"===it&&(et=0,tt=5),Mt===At[0]?(rt=1e3,Tt=60):Mt===At[1]?(rt=800,Tt=65):Mt===At[2]?(rt=600,Tt=70):Mt===At[3]?(rt=500,Tt=80):(console.error("Something went terribly wrong! \n Couldnt find the selected difficulty. Setting default seetings."),rt=1e3,Tt=60),ut=!1,st=(vt-(2*yt*jt+2*yt))/jt,nt=(vt-(2*yt*Bt+2*yt))/Bt}function o(){if(ot=new Phaser.Filter(mt,null,t()),ot.setResolution(vt,kt),!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(gt=mt.input.keyboard.createCursorKeys(),gt.left.onDown.add(function(){at.move("left")},this),gt.right.onDown.add(function(){at.move("right")},this),gt.down.onDown.add(function(){at.move("down")},this),gt.up.onDown.add(function(){at.move("up")},this),xt===!0)){var e=[87,65,68,83],o=["up","left","right","down"];Ct=mt.input.keyboard.addKeys(e,o),Ct.up.onDown.add(function(){ht.move("up")},this),Ct.left.onDown.add(function(){ht.move("left")},this),Ct.right.onDown.add(function(){ht.move("right")},this),Ct.down.onDown.add(function(){ht.move("down")},this)}if(St.isCountdownEnabled===!0){var i=mt.add.sprite();i.width=vt,i.height=kt,i.filters=[ot];var r=mt.add.text(mt.world.centerX/1.15,mt.world.centerY/1.3,"5",{font:"Bold "+vt/5+"px Arial",fill:"rgb(0, 179, 204)",align:"center"});setTimeout(function(){r.text="4",setTimeout(function(){r.text="3",setTimeout(function(){r.text="2",setTimeout(function(){r.text="1",setTimeout(function(){r.text="",i.destroy(),console.clear(),console.log("SkipStack version: "+St.version+"\nGrid Scale: "+jt+", "+Bt+"\nGameType: "+it+"\nDifficulty: "+Mt),St.isCountdownEnabled=!1},500)},500)},500)},500)},500)}if(lt=new Color,ct=new Grid(jt,Bt,st,nt,"#333","#ffffff",2*yt),ct.init(),xt===!0)at=new Actor(Wt,"0-"+Math.floor(Bt/2)),ht=new Actor(Wt,jt-1+"-"+Math.ceil(Bt/2)),at.init(),ht.init();else{if(Dt===!0)at=new Actor(Wt);else{var s=at._c;at=new Actor(Wt,ct.cell[s].HashId)}at.init()}xt===!1&&a(3+Pt),Et=mt.time.time+rt,Dt=Gt=!1,pt=mt.time.now,$("#gamecont").swipe({swipe:function(t,e,o,i,r,s){at.move(e)},threshold:0})}function i(){if(St.isCountdownEnabled===!0)return ot.update();var t,e;if(Nt===!0&&ot.update(),ct.render(),mt.time.time>Et){for(t=0;t<dt.length;t++)dt[t].move(ft[t]);St.soundsOn&&V.play(),ut=!1,Et=mt.time.time+rt}else if(ut===!1){for(ft=[],e=0;e<dt.length;e++)ft.push(dt[e].Nextmove());ut=!0}if(!xt)if("Normal"===it)0===dt.length&&c();else if("Endless"===it)bt>tt&&(console.log("Adding more enemies!"),.45>et?(et+=.05,tt*=1.55-et,a(1)):(et+=.5,tt*=1.1,a(Math.round(et))),rt-=10);else if("SkipSmash"===it)1===dt.length&&c();else if("PaintStack"===it)if(Math.floor(at.markedArea)>Tt)c();else if(0===dt.length){for(t=0;t<Math.ceil((Pt+1)/2);t++)e="",e=qt[0]()===!0?qt[0]()===!0?"0-"+h(0,Bt):h(0,jt)+"-0":qt[0]()===!0?jt-1+"-"+h(0,Bt):h(0,jt)+"-"+(Bt-1),"Normal"===ct.cell[ct.getCell(e)].type?dt.push(new Enemy(zt,e)):t--;for(e=0;e<dt.length;e++)dt[e].init()}$t=Math.round((Et-mt.time.time)/rt*100),bt=Math.round((mt.time.now-pt)/1e3),A(),s()}function r(){var t=$(".bar");$t%20===0&&t.css("background-color","rgb("+255*(100-$t)/100+", "+255*$t/100+", 0)"),t.css("width",$t+"%")}function s(){mt.debug.text("grid: "+jt+"-"+Bt,3,14,"#b1ff00"),mt.debug.text("enemies: "+dt.length,3,27,"#b1ff00"),mt.debug.text("beat rate: "+rt+" ms",3,40,"#b1ff00"),mt.debug.text("Interval: "+$t+" %",3,53,20>$t?"#ff0000":"#00ff27"),mt.debug.text("time: "+bt+" s",3,66,"#b1ff00"),mt.debug.text("Current Score: "+St.CurrentScore,3,79,"#b1ff00"),mt.debug.text("Total Score: "+St.TotalScore,3,92,"#b1ff00"),"PaintStack"===it&&mt.debug.text("marked area: "+Math.floor(at.markedArea)+"%",3,92,"#b1ff00")}function n(){console.clear(),St.soundsOn&&Z[h(0,Z.length)].play(),Dt=!0,Bt=jt=7,pt=mt.time.now,St.CurrentScore=Pt=Xt=0,St.isCountdownEnabled=!0,mt.state.start(mt.state.current)}function l(){"Normal"===it?St.TotalScore[0]+=St.CurrentScore:"SkipSmash"===it?St.TotalScore[2]+=St.CurrentScore:"Endless"===it?St.TotalScore[1]+=St.CurrentScore:"PaintStack"===it&&(St.TotalScore[3]+=St.CurrentScore)}function c(){console.clear();var t=Math.ceil(jt+Xt*jt/2);St.soundsOn&&J[h(0,J.length)].play(),Gt=!0,Pt++,"Normal"===it?(Dt=!0,3+Pt>t&&(Xt++,Bt=++jt)):"SkipSmash"===it?(Dt=!0,3+Pt>Math.ceil(jt+Xt*jt/3)&&(Xt++,Bt=++jt)):"PaintStack"===it&&(Dt=!0,3+Pt>Math.ceil(jt+Xt*jt/4)&&(Bt=++jt)),St.isCountdownEnabled=!1,mt.state.start(mt.state.current)}function a(t){var e,o="";for(e=0;t>e;e++)o=qt[0]()===!0?qt[0]()===!0?"0-"+h(0,Bt):h(0,jt)+"-0":qt[0]()===!0?jt-1+"-"+h(0,Bt):h(0,jt)+"-"+(Bt-1),"Normal"===ct.cell[ct.getCell(o)].type?dt.push(new Enemy(zt,o)):e--,dt[dt.length-1].init()}function h(t,e){return Math.floor(Math.random()*(e-t))+t}function d(t,e){var o=$(""),i=new M(t,e);for(i.top--,i.left--;i.top<i.bottom;i.top++)o=f(i.top,i.left,i.right,o);return o}function f(t,e,o,i){for(var r,s,n,l=$(".gamecont");o>e;e++)n=_t*t,s=_t*e,r=$('<div class="cell" id="'+Number(t+1)+"-"+Number(e+1)+'" />'),r.css({left:s,top:n}),l.append(r),i=i.add("#"+Number(t+1)+"-"+Number(e+1));return i}function u(t,e){var o=new M(t,e);for(x=o.top;x<=o.bottom;x++)for(y=o.left;y<=o.right;y++)$(".cell#"+x+"-"+y).css({border:yt+"px solid #bbb",width:_t,height:_t})}function p(){var t,e=$(window).height(),o=$(window).height(),i=Math.floor(o/7),r=Math.floor(e/13);i>r?(t=r,yt=Math.floor(.00781634663*e/2)):(t=i,yt=Math.floor(.00781634663*o/2)),_t=t-1,kt=vt=7*_t}function b(t){this.bar=$("<div />"),this.barbg=$("<div />"),this.barfg=$("<div />"),this.barfg.css({width:"100%",position:"absolute",height:_t/4,bottom:0-_t/4,left:"0","z-index":129,"border-left":2*yt+"px solid rgb(0, 0, 0)","border-right":2*yt+"px solid rgb(0, 0, 0)","border-bottom":2*yt+"px solid rgb(0, 0, 0)","box-sizing":"border-box"}),this.barbg.css({"background-color":"rgb(255, 255, 255)",width:"100%",position:"absolute",height:_t/4,bottom:0-_t/4,left:"0","z-index":127}),this.bar.addClass("bar"),this.bar.css({"background-color":"rgb(0, 128, 0)",width:"100%",position:"absolute",height:_t/4,bottom:0-_t/4,left:"0","z-index":128}),this.bar.appendTo($(t)),this.barbg.appendTo($(t)),this.barfg.appendTo($(t))}function m(t,e,o){var i=Number(t.split("-")[0]),r=Number(t.split("-")[1]),s=Number(e.split("-")[1])-r,n=Number(e.split("-")[0])-i,l=$("<div />");return l.css({position:"absolute",width:(s+1)*_t,height:(n+1)*_t,top:(i-1)*_t,left:(r-1)*_t}),$(".gamecont").append(l.addClass(o)),$("."+o)}function g(t,e,o,i,r){this.size=t,this.left=e,this.content=o,this.text=i,this.rendered=!1,this.generate=function(){this.rendered=!0,this.tl=T(this.left),this.br=[this.tl[0],this.tl[1]+(this.size-1)],this["class"]="cls_"+this.text,this.flipcard=C(this.tl[0]+"-"+this.tl[1],this.br[0]+"-"+this.br[1],this["class"]),this.area=this.flipcard.children(".back"),this.area.css({"background-color":"#ffffff",border:yt+"px solid #000000","box-sizing":"border-box"}),B(this.text,this.area),this.text=function(t){return void 0!==t&&this.area.children("div").text(t),this.area.children("div").text()},this.refresh=function(){this.rendered&&this.text(r())},this.flip=function(){O(this.flipcard)}}}function C(t,e,o){var i=R(),r=R(),s=R(),n=(Number(t.split("-")[0])-1)*_t,l=(Number(t.split("-")[1])-1)*_t,c=F(t,e,i);c.addClass("front"),c.addClass(o),c.addClass(s),L(c,n,l);var a=m(t,e,r),h=a.css("width"),d=a.css("height");I(a,n,l),a.css("background-color","aqua"),a.addClass("back"),a.addClass(o),a.addClass(s),c.css({top:n,left:l,width:h,height:d});var f=$("<div />");return f.css({position:"absolute",top:n+"px",left:l+"px",width:h,height:d,"z-index":w()}),f.addClass("flipcard "+o),f.attr({"data-tl":t,"data-br":e}),$("."+s).wrapAll(f),$("."+o+" > *").removeClass(i),$("."+o+" > *").removeClass(r),$("."+o+" > *").removeClass(s),$(".flipcard."+o)}function v(t,e){t.children(".front").remove();var o=t.css("top"),i=t.css("left"),r=t.data("tl"),s=t.data("br");return t=t.children(".back"),t.attr({"data-tl":r,"data-br":s}),t.css({top:o,left:i,"z-index":w()}),t.children(".back").removeClass("back"),t.unwrap(),void 0!==e&&(wt=t,e()),t}function k(t,e){var o=$("<div />"),i=$("<div />");o.css({position:"absolute",top:t.css("top"),left:t.css("left"),width:t.css("width"),height:t.css("height"),"z-index":w()}),o.addClass("flipcard "+e),o.attr({"data-tl":t.data("tl"),"data-br":t.data("br"),"data-face":"front"}),t.addClass("front"),t.removeClass("back"),t.css({top:"0",left:"0"}),i.attr("style",t.attr("style")),i.css("backface-visibility","hidden"),i.addClass("back "+e),i.insertAfter(t);$("."+e).wrapAll(o);return $("."+e).not(".back, .front")}function _(t){$.getScript(t,function(){console.log("loaded "+t)})}function w(){return Ht+=1}function S(t,e){return e?t.push(t.shift()):t.unshift(t.pop()),t}function T(t){return[Number(t.split("-")[0]),Number(t.split("-")[1])]}function A(){r(),Ft.refresh()}function M(t,e){this.top=T(t)[0],this.left=T(t)[1],this.bottom=T(e)[0],this.right=T(e)[1]}function N(){u("1-1","13-7"),$(".gamecont").css({border:yt+"px solid #bbb",width:7*_t,height:13*_t})}function E(t){if(it=Yt[0],"PaintStack"===it)Ft=new g(2,"2-1","enemies","en",function(){return Math.floor(at.markedArea)+"%"});else if("Endless"===it)Ft=new g(2,"2-1","enemies","en",function(){return Math.round(bt)+" s"});else{var r=St.CurrentScore.toString().length>3?St.CurrentScore.toString().length-1:2;Ft=new g(r,"2-1","enemies","en",function(){return Math.round(St.CurrentScore)})}var s=K("4-1","10-7","SkipStack",[".preview",".prev",".next",".modeselector"]);s.children(".back").attr("id","SkipStack"),mt=new Phaser.Game(vt,kt,Phaser.AUTO,"SkipStack",{preload:e,create:o,update:i,maxWidth:7*_t,maxHeight:7*_t});b("#SkipStack");return"PaintStack"===Yt[0]&&(Ft.refresh=function(){Ft.rendered&&this.text(Math.floor(at.markedArea)+"%")}),Ft.generate(),O(s.not(".SkipStack>*")),setTimeout(function(){v(s)},500),setTimeout(function(){Ft.flip()},300),void 0!==t&&t(),s}function j(t,e){var o=$("<div />");return o.css({width:t*_t+"px","text-align":"center","font-size":.8*_t+"px",position:"fixed",top:"50%",transform:"translateY(-50%)"}),o.text(e),o}function B(t,e){var o,i;e.hasClass("back")?(o=e.parent().data("tl"),i=e.parent().data("br")):(o=e.data("tl"),i=e.data("br"));var r=Number(i.split("-")[1])-Number(o.split("-")[1])+1,s=j(r,t);return s.appendTo(e),e}function P(){var t=C("10-1","10-1","prev"),e=C("10-7","10-7","next");t.children(".back").css({"box-sizing":"border-box","background-color":"#ffffff",border:yt+"px solid rgb(0, 0, 0)"}).click(function(){X()}),e.children(".back").css({"box-sizing":"border-box","background-color":"#ffffff",border:yt+"px solid rgb(0, 0, 0)"}).click(function(){G()});var o=C("10-2","10-6","modeselector"),i=C("4-2","7-6","preview");o.children(".back").css({"box-sizing":"border-box","background-color":"#ffffff",border:yt+"px solid rgb(0, 0, 0)"}),B("Normal",o.children(".back")),i.children(".back").css({"box-sizing":"border-box","background-color":"#ffffff",border:yt+"px solid rgb(0, 0, 0)"}),B("[Normal preview]",i.children(".back")),setTimeout(function(){t=O(t)},100),setTimeout(function(){i=O(i)},200),setTimeout(function(){e=O(e)},100),o=O(o),setTimeout(function(){o=v(o,z),i=v(i,W),e=v(e),t=v(t)},1e3)}function W(){wt=k(wt,"preview"),B("disp",wt.children(".back")),wt.click(function(){E()})}function z(){wt=k(wt,"modeselector"),B("disp",wt.children(".back")),wt.click(function(){E()})}function D(t,e,o){"front"==t.data("face")?(t.data("face","back"),t.children(".back > div").text(e)):(t.data("face","front"),t.children(".front > div").text(e)),O(t.not(".flipcard > *"),o)}function G(){S(Yt,!0),setTimeout(function(){D($(".preview"),"["+Yt[0]+" preview]")},50),D($(".modeselector"),Yt[0])}function X(){S(Yt),setTimeout(function(){D($(".preview"),"["+Yt[0]+" preview]",!0)},50),D($(".modeselector"),Yt[0],!0)}function q(t){var e=t.split("-")[0],o=t.split("-")[1];return $("#"+e+"-"+o)}function H(t,e,o,i){for(;e+1>=t;t++)i=i.add(q(o+"-"+t));return i}function Y(t,e){for(var o=$(""),i=Number(t.split("-")[0]),r=Number(t.split("-")[1]),s=Number(e.split("-")[0]),n=Number(e.split("-")[1])-1;s>=i;i++)o=H(r,n,i,o);return o}function F(t,e,o){return Y(t,e).wrapAll('<div class="'+o+'"/>'),$("."+o)}function O(t,e,o){t.css("z-index",w()),void 0===t.data("rotation")&&t.data("rotation",0);var i,r=t.data("rotation");return e?(i=180*Number(r)-180,r--):(i=180*Number(r)+180,r++),t.transition({perspective:"800px",rotateY:i+"deg"}),t.data("rotation",r),void 0!==o&&o(t,o),t}function R(){for(var t="",e="abcdefghijklmnopqrstuvwxyz",o=0;5>o;o++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function L(t,e,o){return t.children(".cell").each(function(){$(this).css("top",Number($(this).css("top").split("px")[0])-e+"px"),$(this).css("left",Number($(this).css("left").split("px")[0])-o+"px")}),t}function I(t,e,o){return t.css({top:Number($(t).css("top").split("px")[0])-e+"px",left:Number($(t).css("left").split("px")[0])-o+"px"}),t}function K(t,e,o,i){var r=C(t,e,o),s=$(r.children(".front")),n=T(t);return i.forEach(function(t){I($(t),Number(n[0]-1)*_t,Number(n[1]-1)*_t),s=s.append($(t))}),s.appendTo($("."+o+".front")),r}var V=jsfxlib.createWave(["sine",0,.4,0,.092,0,.208,20,286,2400,-.674,0,0,.01,3e-4,0,0,0,0,0,0,0,0,1,0,0,.048,0]),U=[jsfxlib.createWave(["square",0,.4,0,.028,0,.118,20,525,2400,-.658,0,0,.01,3e-4,0,0,0,.2415,0,0,0,0,1,0,0,.227,0]),jsfxlib.createWave(["square",0,.4,0,.062,0,.284,20,762,2400,-.374,0,0,.01,3e-4,0,0,0,.5,0,0,0,0,1,0,0,.017,0])],J=[jsfxlib.createWave(["square",0,.4,.672,1.424,.351,1.526,636,2166,1208,-.268,.08,.132,35.9545,.6126,-.024,-.948,.757,.0435,.586,.3992,-.974,-.434,.802,-.156,.526,.792,.572]),jsfxlib.createWave(["square",0,.4,.242,1.174,2.097,.946,1529,139,1995,-.206,.884,.769,3.7532,.6438,-.966,-.786,.419,.383,.482,.1912,-.904,-.082,.624,-.568,.015,.345,.26]),jsfxlib.createWave(["synth",0,.4,.082,1.742,2.637,.658,1661,2057,69,.886,.402,.188,17.6703,.9337,.38,-.09,.222,.1315,-.774,.1648,-.16,-.408,.439,-.358,.884,.906,-.1])],Q=jsfxlib.createWave(["sine",0,.4,0,.244,.048,.116,20,507,2400,-.728,0,0,.01,3e-4,0,0,0,.495,.032,0,0,0,1,0,0,0,0]),Z=[jsfxlib.createWave(["square",12,.923,.977,.366,2.139,1.888,137,992,2262,.746,-.918,.001,13.9751,.6581,-.89,.834,.284,.329,-.442,.524,-.542,.638,.214,.952,.974,.794,.802]),jsfxlib.createWave(["square",12,.923,.706,1.82,.933,.534,1837,557,437,.338,-.692,.353,4.761,.8375,.952,.464,.782,.1985,-.084,.0096,-.17,.014,.091,.312,.71,.178,.396]),jsfxlib.createWave(["square",12,.923,.967,1.424,1.212,.438,1982,1391,921,.37,.072,.811,39.1219,.3032,-.802,-.544,.413,.3375,-.468,.0232,.334,.648,.8,-.944,.661,.778,.04]),jsfxlib.createWave(["square",0,1,.063,.922,1.113,1.144,962,357,1708,-.194,-.688,.097,39.9857,.9779,-.05,-.692,.579,.323,.33,.3264,-.226,-.596,.764,-.628,.8,.953,.564])];Actor=function(t,e){this.color,"undefined"==typeof t?(console.error("You gotta give a color! \n Setting default color for now!"),this.color=Wt):this.color=t,"undefined"==typeof e?this.block=Math.floor(jt/2)+"-"+Math.floor(jt/2):this.block=e,this.consecutiveForceflips=0,this._c=0,this.enemiesKilled=0,this.markedArea=0},Actor.prototype={init:function(){this._c=ct.getCell(this.block),ct.cell[this._c].setColor(this.color),ct.cell[this._c].setCellType("Actor")},move:function(t){if(St.isCountdownEnabled===!0)return console.log("Can't move while game is loading!");if("SkipSmash"!==it)switch(t){case"up":this.makeMove(t,this._c-jt);break;case"down":this.makeMove(t,this._c+jt);break;case"left":this.makeMove(t,this._c-1);break;case"right":this.makeMove(t,this._c+1)}else switch(t){case"up":this.thrustEnemy(t,this._c-jt);break;case"down":this.thrustEnemy(t,this._c+jt);break;case"left":this.thrustEnemy(t,this._c-1);break;case"right":this.thrustEnemy(t,this._c+1)}},makeMove:function(t,e){if(ct.cell[this._c].checkCell(t,this._c));else if(St.hasBounds===!1)switch(t){case"up":e=this._c+jt*Bt-jt;break;case"down":e=this._c-jt*Bt+jt;break;case"left":e=this._c+jt-1;break;case"right":e=this._c-jt+1}if("Enemy"===ct.cell[e].type){St.CurrentScore+=100*(1+this.consecutiveForceflips+$t/100),this.consecutiveForceflips++;for(var o=0;o<dt.length;o++){if(dt[o]._c===e){dt.length&&St.soundsOn&&U[h(0,U.length)].play(),dt.splice(o,1),ft.splice(o,1);break}o===dt.length-1&&console.error("Snap! Couldn't find the enemy")}}else this.consecutiveForceflips=0;ct.cell[this._c].setCellType("Normal"),"PaintStack"!==it?(ct.cell[this._c].setColor(ct.c2),this._c=e,ct.cell[this._c].setColor(this.color),ct.cell[this._c].setCellType("Actor")):(ct.cell[this._c].isMarked?ct.cell[this._c].setColor(ct.cell[this._c].genColor):ct.cell[this._c].setColor(ct.c2),this._c=e,ct.cell[this._c].isMarked||(this.markedArea+=1/(jt*Bt)*100,ct.cell[this._c].genColor=lt.genetaHSLColor_Angle([{minAngle:320,maxAngle:359},{minAngle:0,maxAngle:40},{minAngle:70,maxAngle:160}]),ct.cell[this._c].isMarked=!0),ct.cell[this._c].setColor(this.color),ct.cell[this._c].setCellType("Actor"))},thrustEnemy:function(t,e){if(ct.cell[this._c].checkCell(t,this._c))if("Enemy"===ct.cell[e].type){for(var o=0;o<dt.length;o++)if(dt[o]._c===e){0!=dt.length&&St.soundsOn&&Q.play(),dt[o].Thrust(t);break}ct.cell[e].checkCell(t,e)&&(ct.cell[this._c].setCellType("Normal"),ct.cell[this._c].setColor(ct.c2),this._c=e,ct.cell[this._c].setColor(this.color),ct.cell[this._c].setCellType("Actor"))}else ct.cell[this._c].setCellType("Normal"),ct.cell[this._c].setColor(ct.c2),this._c=e,ct.cell[this._c].setColor(this.color),ct.cell[this._c].setCellType("Actor")}},Actor.prototype.constructor=Actor,Cell=function(t,e,o,i){this.color=i,this.positionX=t,this.positionY=e,this.HashId=o,this.rect,this.init(),this.type="Normal",this.isMarked=!1,this.isFilterEnabled=!1,this.genColor="#000"},Cell.prototype={init:function(){this.rect=new Phaser.Rectangle(this.positionX,this.positionY,ct.cellWidth,ct.cellWidth)},setCellType:function(t){"Normal"!==t&&"Enemy"!==t&&"Actor"!==t&&"Obstacle"!==t&&alert('type can only be "Enemy","Normal","Actor","Obstacle"'),this.type=t},render:function(){this.isFilterEnabled===!1&&mt.debug.geom(this.rect,this.color)},setColor:function(t){this.color=t},EnableFilter:function(){this.isFilterEnabled=!0,this.rect=mt.add.sprite(this.positionX,this.positionY),this.rect.width=st,this.rect.height=nt,this.rect.filters=[ot]},checkCell:function(t,e){var o,i=!0;switch(t){case"up":i=jt>e?!1:!0;break;case"down":i=e>=jt*Bt-jt?!1:!0;break;case"left":for(o=0;jt>o;o++)e===jt*o&&(i=!1);if(i===!1)break;i=!0;break;case"right":for(o=1;jt>=o;o++)e===jt*o-1&&(i=!1);if(i===!1)break;i=!0}return i}},Cell.prototype.constructor=Cell,Color=function(){this.Color_OceanBlue=10092543,this.Color_SteelBlue=4620980,this.Color_RoyalBlue=4286945,this.Color_Aquamarine=8388564,this.Color_Blue=255,this.Color_BlueViolet=9055202,this.Color_CadetBlue=6266528,this.Color_CornflowerBlue=6591981,this.Color_Cyan=65535,this.Color_DarkBlue=139,this.Color_DarkCyan=35723,this.Color_DodgerBlue=2003199,this.Color_DeepSkyBlue=49151,this.Color_LightSteelBlue=11584734,this.Color_Navy=128,this.Color_PowderBlue=11591910,this.Color_Turquoise=4251856,this.Color_Black=0,this.Color_Violet=15631086,this.Color_Yellow=16776960,this.Color_Tomato=16737095,this.Color_PaleVioletRed=14381203,this.Color_Red=16711680,this.Color_Wheat=16113331,this.Color_AntiqueWhite=16444375,this.Color_White=16777215},Color.prototype={generateHexColor:function(){return"#"+(16777215*(.5+.5*Math.random())<<0).toString(16)},genetaRGBAColor:function(){return"rgba("+h(0,256)+","+h(0,256)+","+h(0,256)+","+Math.random()+")"},genetaRGBColor_max:function(t,e,o){for(var i=[h(0,256),h(0,256),h(0,256)];i[0]>t;)i[0]/=2;for(;i[1]>t;)i[1]/=2;for(;i[2]>t;)i[2]/=2;return"rgba("+Math.round(i[0])+","+Math.round(i[1])+","+Math.round(i[2])+", 1)"},genetaRGBColor:function(){return"rgba("+h(0,256)+","+h(0,256)+","+h(0,256)+", 1)"},genetaHSLColor:function(){return"hsl("+h(0,360)+",30%,30%)"},genetaHSLColor_Angle:function(t){for(var e=0,o=h(0,360);e<t.length;)o>=t[e].minAngle&&o<=t[e].maxAngle&&(o=h(0,360),e=-1),e++;return"hsl("+o+","+h(30,61)+"%,30%)"},genetaHSLAColor:function(){return"hsl("+h(0,360)+",30%,30%,"+Math.random()+")"}},Color.prototype.constructor=Color,Enemy=function(t,e){this.color,"undefined"==typeof t?(console.error("You gotta give a color! \n Setting default color for now!"),this.color=zt):this.color=t,"undefined"==typeof e?alert('Error : "blockID" is undefined'):this.block=e,this.isDead=!1,this._c=0,ct.cell[ct.getCell(this.block)].type="Enemy"},Enemy.prototype={init:function(){this._c=ct.getCell(this.block),ct.cell[this._c].setColor(this.color),ct.cell[this._c].setCellType("Enemy")},move:function(t){var e=0;switch(t){case"up":ct.cell[this._c].checkCell(t,this._c)&&"Enemy"!==ct.cell[this._c-jt].type&&(e=this._c-jt);break;case"down":ct.cell[this._c].checkCell(t,this._c)&&"Enemy"!==ct.cell[this._c+jt].type&&(e=this._c+jt);break;case"left":ct.cell[this._c].checkCell(t,this._c)&&"Enemy"!==ct.cell[this._c-1].type&&(e=this._c-1);break;case"right":ct.cell[this._c].checkCell(t,this._c)&&"Enemy"!==ct.cell[this._c+1].type&&(e=this._c+1)}e&&(ct.cell[this._c].setCellType("Normal"),ct.cell[this._c].setColor(ct.c2),this._c=e,"PaintStack"===it&&ct.cell[this._c].isMarked&&(at.markedArea-=1/(jt*Bt)*100,ct.cell[this._c].isMarked=!1),ct.cell[this._c].setColor(this.color),ct.cell[this._c].setCellType("Enemy"))},Nextmove:function(){var t=at._c-this._c,e=Math.round(ct.getRow(at._c)-ct.getRow(this._c)),o=Math.round(ct.getColumn(at._c)-ct.getColumn(this._c));return t?e>0&&qt[0]()?"down":0>e&&qt[0]()?"up":o>0?"right":"left":n()},Thrust:function(t){var e,o,i;switch(t){case"up":for(e=this._c-jt,o=0;jt>o&&(e=this._c-jt,ct.cell[this._c].checkCell(t,this._c));o++){if("Enemy"===ct.cell[e].type)for(i=0;i<dt.length;i++)if(dt[i]._c===e){ct.cell[e].type="Normal",dt.splice(i,1),ft.splice(i,1);break}this.move(t)}break;case"down":for(e=this._c+jt,o=0;jt>o&&(e=this._c+jt,ct.cell[this._c].checkCell(t,this._c));o++){if("Enemy"===ct.cell[e].type)for(i=0;i<dt.length;i++)if(dt[i]._c===e){ct.cell[e].type="Normal",dt.splice(i,1),ft.splice(i,1);break}this.move(t)}break;case"left":for(e=this._c-1,o=0;jt>o&&(e=this._c-1,ct.cell[this._c].checkCell(t,this._c));o++){if("Enemy"===ct.cell[e].type)for(i=0;i<dt.length;i++)if(dt[i]._c===e){ct.cell[e].type="Normal",dt.splice(i,1),ft.splice(i,1);break}this.move(t)}break;case"right":for(e=this._c+1,o=0;jt>o&&(e=this._c+1,ct.cell[this._c].checkCell(t,this._c));o++){if("Enemy"===ct.cell[e].type)for(i=0;i<dt.length;i++)if(dt[i]._c===e){ct.cell[e].type="Normal",dt.splice(i,1),ft.splice(i,1);break}this.move(t)}}}},Enemy.prototype.constructor=Enemy,Grid=function(t,e,o,i,r,s,n){this.c=r,this.c2=s,"undefined"==typeof n?this.borderThickness=2:this.borderThickness=n,this.cellsCountX=t,this.cellsCountY=e,this.cellWidth=o,this.cellHeight=i,this.grid,this.cell=[]},Grid.prototype={init:function(){var t=this.cellsCountX*this.cellWidth+this.borderThickness*this.cellsCountX+this.borderThickness,e=this.cellsCountY*this.cellHeight+this.borderThickness*this.cellsCountY+this.borderThickness;this.grid=new Phaser.Rectangle((vt-t)/2,(kt-e)/2,t,e),e=(kt-e)/2,t=(vt-t)/2;for(var o=0;o<this.cellsCountY;o++)for(var i=0;i<this.cellsCountX;i++){var r=t+this.borderThickness*(i+1)+this.cellWidth*i,s=e+this.borderThickness*(o+1)+this.cellHeight*o;this.cell.push(new Cell(r,s,i.toString()+"-"+o.toString(),this.c2))}},getCell:function(t){for(var e=0;e<this.cell.length;e++)if(this.cell[e].HashId==t)return e;return console.log("Couldn't find the cell with id = "+t),-1},render:function(){for(var t=0;t<this.cell.length;t++)this.cell[t].render()},getRow:function(t){for(var e=this.cellsCountX,o=0;o<this.cellsCountX;o++){if(e>t)return o;e+=this.cellsCountX}console.error("Something went terribly wrong! \n Couldn't find the row of a cell.")},getColumn:function(t){for(var e=0;e<this.cellsCountX;e++)for(var o=0;o<this.cellsCountX;o++)if(t===e+o*this.cellsCountX)return e;console.error("Something went terribly wrong! \n Couldn't find the column of a cell.")}},Grid.prototype.constructor=Grid;var tt,et,ot,it,rt,st,nt,lt,ct,at,ht,dt,ft,ut,pt,bt,mt,gt,Ct,vt,kt,_t,yt,wt,xt=!1,St=St||{version:"0.0.1",renderer:["Phaser.WebGL","GLSL"],soundsOn:!0,TotalScore:[0,0,0,0],CurrentScore:0,isPaused:!0,isCountdownEnabled:!0,hasBounds:!1},Tt=60,At=["Easy","Normal","Hard","Insane"],Mt=At[0],Nt=!1,$t=0,Et=0,jt=7,Bt=7,Pt=0,Wt="#006400",zt="#b50000",Dt=!0,Gt=!1,Xt=0,qt=[function(){return Math.random()<.5},function(){return!(Math.random()+.5|0)},function(){return!(+new Date%2)}],Ht=0,Yt=["Normal","Endless","SkipSmash","PaintStack"];$(document).ready(function(){p(),d("1-1","13-7"),N(),$("#using_builder").length<=0&&(console.log("Loading Scripts"),_("src/Math.js"),_("src/Cell.js"),_("src/Swipe.js"),_("src/Actor.js"),_("src/Enemy.js"),_("src/Assets/Tunes.js"),_("src/Assets/Shaders.js"),_("src/Grid.js"),_("src/Color.js"),_("src/index.js"),console.log("Loaded Scripts")),P()});var Ft}();
//# sourceMappingURL=skipstack.min.js.map
